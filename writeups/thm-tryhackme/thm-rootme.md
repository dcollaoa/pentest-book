---
description: https://tryhackme.com/room/rrootme
---

# 游릴 THM - RootMe

### **Enumeration**

**Establecer el objetivo**

Primero, establecemos el objetivo utilizando el comando settarget con la direcci칩n IP de la m치quina objetivo:

```bash
settarget 10.10.192.58 RootMe
```

\
**Ping de reconocimiento**

Realizamos un ping a la m치quina objetivo para verificar la conectividad y obtener informaci칩n sobre la ruta utilizando la opci칩n -R para incluir la ruta de retorno:

```bash
ping -c 1 10.10.192.58 -R
```

<figure><img src="../../.gitbook/assets/image (146).png" alt=""><figcaption></figcaption></figure>

**Escaneo de puertos con Nmap**

Luego, realizamos un escaneo de puertos utilizando Nmap para identificar los puertos abiertos en la m치quina objetivo. Utilizamos las opciones -p- para escanear todos los puertos, --open para mostrar solo los puertos abiertos, -sS para un escaneo de tipo TCP SYN, --min-rate 5000 para establecer la velocidad m칤nima de paquetes y -vvv para un nivel de verbosidad alto. Adem치s, utilizamos -n para desactivar la resoluci칩n de DNS, -Pn para no realizar el escaneo de ping, y -oG allPorts para guardar la salida en un archivo con formato Greppable:

```bash
sudo nmap -p- --open -sS --min-rate 5000 -vvv  -n -Pn 10.10.192.58 -oG allPorts
```

<figure><img src="../../.gitbook/assets/image (147).png" alt=""><figcaption></figcaption></figure>

Posteriormente, realizamos un escaneo m치s detallado de los puertos identificados utilizando la opci칩n -sCV para detecci칩n de versiones y scripts de enumeraci칩n de servicios. Espec칤ficamente, indicamos los puertos a escanear con -p \_\_PORTS\_\_ (reemplazando \_\_PORTS\_\_ con los puertos identificados en el paso anterior) y guardamos la salida en un archivo de texto con el nombre targeted:

```bash
sudo nmap -sCV -p22,80 10.10.192.58 -oN targeted
```

<figure><img src="../../.gitbook/assets/image (144).png" alt=""><figcaption></figcaption></figure>

#### Utilizando WhatWeb para Obtener Informaci칩n sobre el Objetivo

Para obtener m치s informaci칩n sobre nuestro objetivo, utilizamos la herramienta WhatWeb. Esta herramienta nos permite identificar tecnolog칤as web utilizadas en el servidor, como el sistema de gesti칩n de contenidos (CMS), el lenguaje de programaci칩n, los plugins y otras caracter칤sticas. Ejecutamos el siguiente comando:

```bash
whatweb 10.10.192.58 > whatweb && cat whatweb -l java
```

<figure><img src="../../.gitbook/assets/image (145).png" alt=""><figcaption></figcaption></figure>

### Directory Enumeration con gobuster

En esta ocasi칩n, nos encontramos frente a la m치quina "RootMe" en TryHackMe, con la direcci칩n IP 10.10.192.58. Despu칠s de realizar un escaneo inicial con nmap y descubrir que hay una p치gina web en el puerto 80, estamos utilizando herramientas como gobuster, dirsearch y wfuzz con las wordlists de seclists para encontrar posibles directorios y rutas ocultas en el servidor web.

Estas herramientas nos permiten realizar un an치lisis exhaustivo de la estructura de directorios del servidor, ayud치ndonos a identificar posibles puntos de entrada o vulnerabilidades en la aplicaci칩n web. Es importante utilizar wordlists actualizadas y completas, como las que se encuentran en la ruta por defecto `/usr/share/seclists/`, ya que contienen una gran cantidad de posibles nombres de directorios y archivos que pueden ser 칰tiles en nuestra b칰squeda.

{% code overflow="wrap" %}
```bash
gobuster dir -u http://10.10.192.58 -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -t 50 --timeout 20s 

dirsearch -u http://10.10.192.58 -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -e php,html

wfuzz -c -z file,/usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt --hc 404 http://10.10.192.58/FUZZ
```
{% endcode %}

<figure><img src="../../.gitbook/assets/image (148).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../.gitbook/assets/image (150).png" alt=""><figcaption></figcaption></figure>

Durante la fase de enumeraci칩n y explotaci칩n en el CTF, nos encontramos con un uploader de im치genes que inicialmente no permit칤a la carga de archivos con la extensi칩n `.php`. Sin embargo, utilizando Burp Suite para modificar la extensi칩n del archivo a `.jpg.php5`, logramos subir un archivo que conten칤a un reverse shell en PHP.

<figure><img src="../../.gitbook/assets/image (149).png" alt=""><figcaption></figcaption></figure>

Una vez que conseguimos ejecutar el reverse shell y obtener acceso a la m치quina, nuestro objetivo era encontrar la flag `user.txt`. Para ello, realizamos las acciones necesarias para enumerar el sistema y descubrir posibles vulnerabilidades que nos permitieran escalar privilegios.

<figure><img src="../../.gitbook/assets/image (151).png" alt=""><figcaption></figcaption></figure>

Finalmente, encontramos una vulnerabilidad que nos permiti칩 ejecutar comandos con privilegios de `root`. Utilizando esta t칠cnica, conseguimos obtener la flag `root.txt` y completar con 칠xito el desaf칤o.

<figure><img src="../../.gitbook/assets/image (152).png" alt=""><figcaption></figcaption></figure>

Link de inter칠s: [https://gtfobins.github.io/gtfobins/python/](https://gtfobins.github.io/gtfobins/python/)


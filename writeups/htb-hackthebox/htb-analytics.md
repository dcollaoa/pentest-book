---
description: https://app.hackthebox.com/machines/Analytics
---

# HTB - Analytics

### Reconocimiento

En esta etapa de la metodología de pentesting, nuestro objetivo es recopilar información sobre nuestro objetivo, en este caso, la máquina Analytics de Hack The Box, cuya dirección IP es 10.10.11.233.



**Paso 1: Establecer el objetivo**

Primero, establecemos el objetivo utilizando el comando `settarget` con la dirección IP de la máquina objetivo:

```bash
settarget 10.10.11.233
```

<div data-full-width="true">

<figure><img src="../../.gitbook/assets/image.png" alt=""><figcaption></figcaption></figure>

</div>

**Paso 2: Ping de reconocimiento**

Realizamos un ping a la máquina objetivo para verificar la conectividad y obtener información sobre la ruta utilizando la opción `-R` para incluir la ruta de retorno:

```bash
ping -c 1 10.10.11.233 -R
```

<figure><img src="../../.gitbook/assets/image (58).png" alt=""><figcaption></figcaption></figure>

**Paso 3: Escaneo de puertos con Nmap**

Luego, realizamos un escaneo de puertos utilizando Nmap para identificar los puertos abiertos en la máquina objetivo. Utilizamos las opciones `-p-` para escanear todos los puertos, `--open` para mostrar solo los puertos abiertos, `-sS` para un escaneo de tipo TCP SYN, `--min-rate 5000` para establecer la velocidad mínima de paquetes y `-vvv` para un nivel de verbosidad alto. Además, utilizamos `-n` para desactivar la resolución de DNS, `-Pn` para no realizar el escaneo de ping, y `-oG allPorts` para guardar la salida en un archivo con formato Greppable:

```bash
sudo nmap -p- --open -sS --min-rate 5000 -vvv  -n -Pn 10.10.11.233 -oG allPorts
```

<figure><img src="../../.gitbook/assets/image (59).png" alt=""><figcaption></figcaption></figure>

**Paso 4: Escaneo detallado con Nmap**

Posteriormente, realizamos un escaneo más detallado de los puertos identificados utilizando la opción `-sCV` para detección de versiones y scripts de enumeración de servicios. Específicamente, indicamos los puertos a escanear con `-p __PORTS__` (reemplazando `__PORTS__` con los puertos identificados en el paso anterior) y guardamos la salida en un archivo de texto con el nombre `targeted`:

```bash
sudo nmap -sCV -p22,80 10.10.11.233 -oN targeted
```

<figure><img src="../../.gitbook/assets/image (60).png" alt=""><figcaption></figcaption></figure>

```bash
cat targeted -l java
```

<figure><img src="../../.gitbook/assets/image (61).png" alt=""><figcaption></figcaption></figure>

Para añadir la entrada "10.10.11.233 analytical.htb" al archivo `/etc/hosts`, puedes usar el siguiente comando en la terminal:

```bash
echo "10.10.11.233 analytical.htb" | sudo tee -a /etc/hosts
```

Este comando añade la dirección IP `10.10.11.233` asociada al nombre de host `analytical.htb` al archivo `/etc/hosts` de tu sistema.

<figure><img src="../../.gitbook/assets/image (62).png" alt=""><figcaption></figcaption></figure>

Para realizar un descubrimiento de directorios en un sitio web utilizando Gobuster, puedes utilizar el siguiente comando:

```bash
gobuster dir -u http://analytical.htb/ -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -t 50
```

<figure><img src="../../.gitbook/assets/image (63).png" alt=""><figcaption></figcaption></figure>

Este comando utiliza Gobuster para realizar un escaneo de directorios en el sitio web `http://analytical.htb/`. Utiliza el archivo de palabras `/usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt` como lista de palabras clave para la búsqueda. La opción `-t 50` indica que se deben utilizar 50 threads simultáneos para acelerar el proceso.

**TIP: Instalación de SecLists con apt-get**

Para instalar SecLists en sistemas basados en Debian (como Ubuntu) utilizando `apt-get`, puedes seguir estos pasos:

1.  Actualiza la lista de paquetes disponibles:

    ```bash
    sudo apt-get update
    ```
2.  Instala SecLists:

    ```bash
    sudo apt-get install seclists
    ```

Con estos pasos, SecLists se instalará en tu sistema y podrás acceder a la lista de palabras clave en el directorio `/usr/share/seclists/`.

\
Para realizar un descubrimiento de subdominios utilizando Gobuster, puedes utilizar el siguiente comando:

```bash
gobuster dns -d analytical.htb -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-20000.txt -t 20
```

Este comando utiliza Gobuster en modo DNS para buscar subdominios en el dominio analytical`.htb`. Utiliza el archivo de palabras `/usr/share/seclists/Discovery/DNS/subdomains-top1million-20000.txt` como lista de posibles subdominios. La opción `-t 20` indica que se deben utilizar 20 threads simultáneos para acelerar el proceso.

Navegando en la página de `analytical.htb`, notamos que al intentar acceder al login, este redirecciona a `data.analytical.htb`

<figure><img src="../../.gitbook/assets/image (64).png" alt=""><figcaption></figcaption></figure>

Antes de poder acceder a `data.analytical.htb`, es necesario agregar la siguiente entrada al archivo de hosts de nuestro sistema:

```bash
echo "10.10.11.233 data.analytical.htb" | sudo tee -a /etc/hosts
```

Esta acción nos permite redirigir el tráfico hacia `data.analytical.htb` correctamente.

<figure><img src="../../.gitbook/assets/image (65).png" alt=""><figcaption></figcaption></figure>

Durante la fase de reconocimiento, descubrimos que Metabase tiene una vulnerabilidad conocida, CVE-2023-38646. Decidimos verificar si `data.analytical.htb` es vulnerable a esta CVE realizando pruebas específicas para confirmarlo.

<figure><img src="../../.gitbook/assets/image (66).png" alt=""><figcaption></figcaption></figure>


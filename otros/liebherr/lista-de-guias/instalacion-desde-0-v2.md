# Guía de instalación desde 0 V2.0

#### Uso de script

Para agilizar el proceso de instalación de nuestros equipos, estoy desarrollando un script para automatizar algunos procesos y poder hacer todo de forma más rápida.

En esta guía haremos uso del script por lo que se omite el detalle de dónde y cómo se descargan los software utilizados.

{% code title="script.bat" overflow="wrap" lineNumbers="true" %}
```batch
@echo on

::Created by Diego Collao
::Soporte IT
::Liebherr Chile

::NOTAS
::-------------
::Averiguar sobre Wildcard characters.
::Arreglar para tomar solo el WindowsDefenderATPOnboardingScript de LMC.
::

::-------------
::Establecer contraseña de usuario
::#adm1n4lmc% <--
::-------------
::start compmgmt.msc
::echo "Usuarios y grupos locales -> Usuarios -> Administrador -> Establecer contraseña."
::pause

::-------------
::Verificando con RUNAS
::-------------
::RUNAS /USER:ADMINISTRADOR CMD
::pause

::-------------
::Directorios
::-------------
echo "Copiando scripts y ficheros necesarios para instalacion base."
robocopy "\\lmcsvsccm01\SCCM_apps\scripts" "C:\TempIT" /V /XF "SP.CMD"
robocopy "\\lmcsvsccm01\SCCM_apps\UltraVNC-1.3.8.1" "C:\TempIT\UltraVNC-1.3.8.1" /V /E /Z /R:3 /MT:10
robocopy "\\lmcsvsccm01\SCCM_apps\Teamviewer" "C:\Apps" /V 
robocopy "\\lmcsvsccm01\SCCM_apps\AdobeReaderDC" "C:\TempIT" /V /E /XF "*.api" "AcroRdrDC1*"
robocopy "\\lmcsvsccm01\SCCM_apps\SCCMclient-LC2" "C:\TempIT\SCCMclient-LC2" /V /E /Z 
robocopy "\\lmcsvsccm01\SCCM_apps\CiscoAnyconnect-4.10.05085" "C:\TempIT\CiscoAnyconnect-4.10.05085" /V /E /Z 
robocopy "\\lmcsvsccm01\SCCM_apps\itWatch-53823" "C:\TempIT\itWatch-53823" /V /E /Z 
robocopy "\\lmcsv03\Backup_LMC\scripts" "C:\TempIT" /V /E /Z /XD L*
robocopy "\\lmcsv03\Backup_LMC\scripts\LMCSV03\LMC\Backup" "C:\Apps\Backup" /V /E /Z



::--------------
::WindowsDefenderATPOnboardingScript (EN REVISIÓN)
::--------------
::runas /env /user:ZDVW2K\lmccoda "C:\system32\cmd.exe C:\TempIT\WindowsDefenderATPOnboardingScript - LMC.cmd"
::--------------
::Verify Installation
::--------------
::reg query "HKLM\Software\Microsoft\Windows Advanced Threat Protection\status"
::--------------

::--------------
::UltraNVC-1.3.8.1  (EN REVISIÓN)
::--------------
::runas /env /user:ZDVW2K\lmccoda "C:\system32\cmd.exe C:\TempILT\UltraVNC-1.3.8.1\install.cmd"
::CMD /K "cd C:\TempIT\UltraVNC-1.3.8.1\" 
::start install.cmd

::IF EXIST "C:\TempIT\SCCM\UltraVNC_1.3.8.1-*" (
::    echo 'File EXIST!'
::) ELSE (
::    echo 'File missing!'
::)

::--------------
::
::--------------



```
{% endcode %}

{% hint style="info" %}
El script debe ejecutarse desde una cuenta de Administrador de Liebherr.\
Ejemplo: LMCCODA.\
\
Si se ejecuta desde la cuenta Usuario no se podrá ejecutar correctamente pidiendo credenciales.
{% endhint %}

